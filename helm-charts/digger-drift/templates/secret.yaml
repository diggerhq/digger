{{- if not .Values.drift.secret.useExistingSecret }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "digger-drift.fullname" . }}-secret
  labels:
    {{- include "digger-drift.labels" . | nindent 4 }}
type: Opaque
stringData:
  # Database configuration
  {{- if .Values.drift.secret.databaseUrl }}
  DATABASE_URL: {{ .Values.drift.secret.databaseUrl | quote }}
  {{- end }}
  
  # Drift service configuration
  {{- if .Values.drift.secret.diggerAppUrl }}
  DIGGER_APP_URL: {{ .Values.drift.secret.diggerAppUrl | quote }}
  {{- end }}
  {{- if .Values.drift.secret.diggerDriftReporterHostname }}
  DIGGER_DRIFT_REPORTER_HOSTNAME: {{ .Values.drift.secret.diggerDriftReporterHostname | quote }}
  {{- end }}
  {{- if .Values.drift.secret.diggerHostname }}
  DIGGER_HOSTNAME: {{ .Values.drift.secret.diggerHostname | quote }}
  {{- end }}
  {{- if .Values.drift.secret.diggerWebhookSecret }}
  DIGGER_WEBHOOK_SECRET: {{ .Values.drift.secret.diggerWebhookSecret | quote }}
  {{- end }}
  
  # GitHub configuration
  {{- if .Values.drift.secret.githubAppPrivateKeyBase64 }}
  GITHUB_APP_PRIVATE_KEY_BASE64: {{ .Values.drift.secret.githubAppPrivateKeyBase64 | quote }}
  {{- end }}
  
  # Optional: Sentry monitoring
  {{- if .Values.drift.secret.sentryDsn }}
  SENTRY_DSN: {{ .Values.drift.secret.sentryDsn | quote }}
  {{- end }}
{{- end }}

