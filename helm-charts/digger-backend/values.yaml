# Digger Backend - Terraform Orchestration Service
# This chart deploys the Digger backend service

digger:
  # Replica count
  replicaCount: 1

  # Image configuration
  image:
    repository: ghcr.io/diggerhq/digger/digger-backend-ee
    tag: "latest"
    pullPolicy: IfNotPresent

  # Custom environment variables
  # Format:
  # customEnv:
  #   - name: MY_CUSTOM_ENV
  #     value: "my-value"
  customEnv: []

  # Log level: DEBUG or INFO
  logLevel: "INFO"

  # Resource limits and requests
  resources: {}
  #  requests:
  #    cpu: 100m
  #    memory: 256Mi
  #  limits:
  #    cpu: 500m
  #    memory: 512Mi

  # Health check probes
  livenessProbe:
    httpGet:
      path: /health
      port: 3000
    periodSeconds: 20

  startupProbe:
    httpGet:
      path: /health
      port: 3000
    failureThreshold: 30
    periodSeconds: 10

  # Service configuration
  service:
    type: ClusterIP
    port: 3000

  # Ingress configuration
  ingress:
    enabled: false
    className: ""
    annotations: {}
    host: ""
    path: /
    tls:
      secretName: "digger-backend-tls"

  # Secret configuration
  # REQUIRED: Always use an existing secret for production
  # Create secret with: kubectl create secret generic backend-secrets --from-env-file=backend.env
  secret:
    useExistingSecret: true
    existingSecretName: "backend-secrets"

  # Node selector
  nodeSelector: {}

  # Tolerations
  tolerations: []

  # Affinity
  affinity: {}
