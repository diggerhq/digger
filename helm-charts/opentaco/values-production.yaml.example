# Production values for OpenTaco
# Copy this file and customize for your environment

global:
  imageRegistry: ghcr.io/diggerhq/digger
  imagePullPolicy: IfNotPresent

# ============================================================================
# Database - Use Cloud SQL for production
# ============================================================================
postgresql:
  enabled: false

cloudSql:
  enabled: true
  instanceConnectionName: "YOUR-PROJECT-ID:YOUR-REGION:YOUR-INSTANCE"
  credentialsSecret: "cloudsql-credentials"
  serviceAccount: "cloudsql-sa"

# ============================================================================
# Taco Orchestrator
# ============================================================================
taco-orchestrator:
  enabled: true
  digger:
    replicaCount: 2
    resources:
      requests:
        memory: 512Mi
        cpu: 500m
      limits:
        memory: 2Gi
        cpu: 2000m
    ingress:
      enabled: true
      className: "nginx"
      annotations:
        cert-manager.io/cluster-issuer: "letsencrypt-prod"
      host: "api.opentaco.example.com"  # CHANGE THIS
      path: /
      tls:
        secretName: taco-orchestrator-tls

# ============================================================================
# Taco Statesman
# ============================================================================
taco-statesman:
  enabled: true
  taco:
    replicaCount: 2
    resources:
      requests:
        memory: 512Mi
        cpu: 500m
      limits:
        memory: 2Gi
        cpu: 2000m
    storage:
      type: "s3"  # Use S3/GCS for production
      s3:
        bucket: "opentaco-state-bucket"  # CHANGE THIS
        region: "us-central1"

# ============================================================================
# Drift Detection
# ============================================================================
taco-drift:
  enabled: true
  drift:
    replicaCount: 2
    resources:
      requests:
        memory: 512Mi
        cpu: 500m
      limits:
        memory: 2Gi
        cpu: 2000m

# ============================================================================
# Taco UI
# ============================================================================
taco-ui:
  enabled: true
  ui:
    replicaCount: 3
    resources:
      requests:
        memory: 256Mi
        cpu: 250m
      limits:
        memory: 1Gi
        cpu: 1000m
    ingress:
      enabled: true
      className: "nginx"
      annotations:
        cert-manager.io/cluster-issuer: "letsencrypt-prod"
        nginx.ingress.kubernetes.io/ssl-redirect: "true"
      hosts:
        - host: app.opentaco.example.com  # CHANGE THIS
          paths:
            - path: /
              pathType: Prefix
      tls:
        - secretName: opentaco-ui-tls
          hosts:
            - app.opentaco.example.com  # CHANGE THIS
    env:
      allowedHosts: "app.opentaco.example.com"  # CHANGE THIS
      workos:
        clientId: "client_XXXXX"  # CHANGE THIS - your WorkOS client ID
        secretName: "workos-secrets"
      posthog:
        key: ""  # Optional: Add PostHog key
        host: "https://app.posthog.com"

# ============================================================================
# Optional Features
# ============================================================================
networkPolicies:
  enabled: true

serviceMonitor:
  enabled: false  # Set to true if using Prometheus

